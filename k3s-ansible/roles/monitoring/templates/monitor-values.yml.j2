# Grafana 설정 (대시보드 화면)
grafana:
  # 관리자 비밀번호
  adminPassword: "{{ grafana_admin_password }}"
  
  # 서비스 설정 (외부 접속용 NodePort)
  service:
    type: NodePort
    nodePort: {{ grafana_node_port }} # 30000

  # grafana.ini 설정 (접속 URL 문제 해결용)
  grafana.ini:
    server:
      # 대시보드 링크가 깨지지 않도록 정확한 접속 주소(Master IP)를 명시합니다.
      root_url: "http://{{ cluster_ip }}:{{ grafana_node_port }}"

  # [핵심] 첫 번째 Agent 노드(Fixed Node)에만 설치해라!
  nodeSelector:
    kubernetes.io/hostname: "{{ target_node }}"

  # [t3.micro 최적화] 리소스 제한 (메모리 부족 방지)
  resources:
    requests:
      memory: 64Mi  # 최소 64MB 확보
      cpu: 100m
    limits:
      memory: 256Mi # 최대 256MB까지만 사용

# Prometheus 설정 (데이터 수집기)
prometheus:
  prometheusSpec:
    # 데이터 보존 기간 (용량 절약 위해 7일)
    retention: 7d
    
    # [핵심] Fixed Node에만 설치!
    nodeSelector:
      kubernetes.io/hostname: "{{ target_node }}"
      
    # [t3.micro 최적화] 리소스 제한
    resources:
      requests:
        memory: 256Mi
        cpu: 200m
      limits:
        memory: 512Mi # 최대 512MB (Swap 믿고 설정)

# Alertmanager (알람 발송기)
# t3.micro에서는 리소스 낭비이므로 끕니다.
alertmanager:
  enabled: false
